<!doctype html>
<head>
<meta charset="utf-8">
<title>JavaScript XSLT</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" />
<link rel="stylesheet" href="./cdcatalog.css" />

</head>
<body ng-app="cdcatalogApp">
<div class="container">
  <div class="row">
    <label for="search-equipment-input"><i class="fa fa-search"></i></label>
    <input type="search" ng-model="equipment_search" id="search-equipment-input" class="search" placeholder="Search Equipment" autocomplete="off" spellcheck="false" autocorrect="off" />
    <a href="#" id="search-equipment-clear" class="fa fa-times-circle"></a>
  </div>
  <div id="example" ng-controller="cdcatalogCtrl" />
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0-beta.1/angular.min.js"></script>
<script>
var app = angular.module('cdcatalogApp', [])
.controller('cdcatalogCtrl', function($scope) {


  function loadXMLDoc(filename)
  {
    if (window.ActiveXObject)
      {
      xhttp = new ActiveXObject("Msxml2.XMLHTTP");
      }
    else 
      {
      xhttp = new XMLHttpRequest();
      }
    xhttp.open("GET", filename, false);
    try {xhttp.responseType = "msxml-document"} catch(err) {} // Helping IE11
    xhttp.send("");
    return xhttp.responseXML;
  }

  function displayResult()
  {
  xml = loadXMLDoc("cdcatalog.xml");
  xsl = loadXMLDoc("cdcatalog.xsl");
  // code for IE
  if (window.ActiveXObject || xhttp.responseType == "msxml-document")
    {
    ex = xml.transformNode(xsl);
    document.getElementById("example").innerHTML = ex;
    }
  // code for Chrome, Firefox, Opera, etc.
  else if (document.implementation && document.implementation.createDocument)
    {
    xsltProcessor = new XSLTProcessor();
    xsltProcessor.importStylesheet(xsl);
    resultDocument = xsltProcessor.transformToFragment(xml, document);
    document.getElementById("example").appendChild(resultDocument);
    }
  }

    displayResult.call(this);


    angular.element('#search-equipment-clear').on('click', function(e) {
    e.preventDefault();
    angular.element(this).siblings('input').val('').focus();
    $scope.equipment_search = '';
    $scope.$digest();
  });

  $scope.$watch('equipment_search', function(newVal, oldVal) {
    var re = new RegExp(newVal, 'i');

    var tds = angular.element('#example table td').filter(function(index, value) {
      return re.test(angular.element(value).text()) === true;
    });

    angular.element('#example table td').hide();
    angular.element(tds).show();
  });

});

</script>
</body>
</html>